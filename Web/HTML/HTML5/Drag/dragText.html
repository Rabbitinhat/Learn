<!doctype html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <title>Drag and Drop</title>
    <meta http-equiv="X-UA-Complible" content="IE=Edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <style rel="stylesheet">
        img {
            width: 280px;
        }

        #src>* {
            float: left;
        }

        #target,
        #src>img {
            border: 2px solid #000;
            padding: 2px;
            margin: 4px;
        }

        #target {
            height: 500px;
            width: 300px;
            display: flex;
            align-content: center;
        }

        #target>img {
            box-sizing: border-box;
            width: 100%;
        }

        /* 使用event drag */
        #src>img.dragged {
            border: 2px solid orangered;
        }
    </style>
</head>

<body>
    <!-- Chrome&Opera(webkit) 只能拖动最新设置draggable="true"元素 -->
    <!-- Firefox&Edge 三个元素都可以拖动 -->
    <div id="src">
        <img src="./pic1.jpg" alt="pic1" id="pic1" draggable="true">
        <img src="./pic2.jpg" alt="pic2" id="pic2" draggable="true">
        <img src="./pic3.jpg" alt="pic3" id="pic3" draggable="true">
        <div id="target">
            <p id="msg">Drop Here</p>
        </div>
    </div>
    <script>
        let src = document.getElementById("src");
        let target = document.getElementById("target");

        /* 拖动事件 */
        let msg = document.getElementById("msg");

        /* 接收释放 */



        src.ondrag = function (e) {
            msg.innerHTML = e.target.alt;
        }

        /* 释放区 */
        /* 阻止dragenter & dragover 的默认行为 */
        /* 将target变为可释放区 */
        target.ondragenter = handleDrag;
        target.ondragover = handleDrag;

        /* 使用dataTransfer对象过滤元素 */
        /* chrome & edge 都不可用 */
        function handleDrag(e) {
            if (e.dataTransfer.getData("Text") == "pic3") {
                e.preventDefault();
            }
        }



        /* ?.clone() */
        /* 使用dataTransfer对象, 传输数据; 可以跨浏览器拖动 */
        target.ondrop = function (e) {
            var draggedID = e.dataTransfer.getData("Text");
            let newElem = document.getElementById(draggedID).cloneNode(false);
            target.innerHTML = "";
            target.appendChild(newElem);
            e.preventDefault();
        }

        src.ondragstart = function (e) {
            e.dataTransfer.setData("Text", e.target.id);
            e.target.classList.add("dragged");
        }


        src.ondragend = function (e) {
            let elems = document.querySelectorAll(".dragged");
            for (let i = 0; i < elems.length; i++) {
                elems[i].classList.remove("dragged");
            }
        }
    </script>
</body>

</html>