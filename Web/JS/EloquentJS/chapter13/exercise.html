<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <style rel="stylesheet">
      #content {
        width: 252px;
        height: 47px;
        background-color: yellowgreen;
        position: fixed;
        border-radius: 10px;
        color: #fff;
        text-align: center;
        line-height: 47px;
      }
    </style>
  </head>
  <body>
    <p>
      Lorem ipsum dolor sit amet consectetur, adipisicing elit. Alias optio
      provident mollitia, incidunt eius voluptatibus, dolores reiciendis, qui in
      similique adipisci officia sint tenetur exercitationem! Accusantium hic
      quia in autem. Maiores eaque ipsa pariatur quo error distinctio enim
      commodi aliquid, veritatis rerum deserunt nulla blanditiis similique iste
      iure quos accusantium expedita id nostrum nam aliquam eveniet voluptates
      perspiciatis laborum. Officiis. Labore soluta nihil similique consectetur
      nostrum temporibus saepe obcaecati asperiores atque. Vero temporibus
      mollitia iusto expedita nulla ab officia ipsam corrupti, hic tempore illum
      quaerat odio quia voluptas culpa deserunt. Illum aliquam culpa ducimus vel
      distinctio doloribus. Debitis deserunt voluptatibus non placeat enim
      totam, dolorem ad! Recusandae modi fuga culpa odit. Quidem harum soluta,
      tenetur repudiandae id ullam tempore perspiciatis. Obcaecati fugit
      repellendus distinctio delectus libero dolores incidunt maxime. Quidem
      porro ex a possimus quam nulla dicta molestias est eum, officia dolores
      deleniti. Recusandae, quam ipsa. Expedita ipsa ipsum sed? Aut sit
      provident alias nostrum natus cumque facere iure earum fugiat amet, vero
      sed minus asperiores libero. Voluptatum quod voluptatibus provident, a
      sequi id libero facilis expedita adipisci, nam amet? Libero aut sed
      numquam maxime, placeat animi! Voluptates libero ad possimus culpa quidem
      reiciendis perferendis eos suscipit atque quaerat delectus illo fugit sed
      voluptatem autem obcaecati, quos voluptate expedita perspiciatis. Officia,
      eius voluptatum nemo enim consequuntur ducimus asperiores vel nam, quidem
      autem eum, corrupti ex aperiam nulla. A voluptatum eveniet est officia
      optio aspernatur non impedit, voluptatem, similique, animi quam.
      Consequuntur mollitia perferendis laborum. Deleniti incidunt rerum eveniet
      tenetur, rem numquam suscipit ea tempore commodi quasi earum quis tempora
      dolores cupiditate asperiores exercitationem aut accusantium hic eligendi
      iure consequatur inventore. Illum excepturi doloremque unde alias.
      Architecto soluta minima voluptas maiores laboriosam quibusdam, sapiente,
      corporis, iure impedit recusandae magnam sit et reiciendis consequuntur
      nesciunt sequi? Vitae corporis veritatis illum ut a? Possimus iste commodi
      sint illo asperiores minus magni, mollitia voluptate hic quaerat, suscipit
      facilis inventore voluptas eum et repellat id magnam consectetur
      veritatis. Sequi, perferendis. Dolorem distinctio placeat eligendi ab.
      Vero iure debitis porro necessitatibus saepe earum itaque consequuntur
      pariatur impedit, magni numquam animi doloribus laboriosam fuga quas
      cupiditate quidem corporis, a rerum quo nulla odio? Vitae eligendi odit
      voluptates. Ea doloremque, architecto eum eveniet totam corrupti sed
      laudantium voluptate commodi similique atque quam laborum quidem dolor,
      temporibus perferendis adipisci quas sequi fugit magnam laboriosam veniam
      vitae blanditiis. Aut, hic! Voluptatum, voluptas assumenda expedita
      exercitationem autem similique nisi eum vel quibusdam labore perspiciatis
      mollitia porro veritatis cum. Iusto aspernatur, mollitia, dicta ab,
      aliquam nostrum reprehenderit ipsum quod quia blanditiis aperiam?
      Laboriosam iusto alias, tempore blanditiis accusantium dolorem ipsam
      facere quibusdam repudiandae a amet optio repellendus cupiditate esse,
      officia dignissimos dolor molestias rerum tempora laborum! Ipsa fugiat
      rerum vel assumenda necessitatibus? Ipsam quia unde accusantium rem
      consequuntur veniam. Minus dicta unde ratione labore quia incidunt cumque
      quos, beatae accusantium, impedit reiciendis ipsa voluptas perspiciatis?
      Optio veritatis sed doloribus obcaecati rem voluptatem. Suscipit eligendi
      placeat dolores eum distinctio dolor quia eos laudantium minus similique
      rerum explicabo aliquid hic tempore, atque ea fugiat! Assumenda blanditiis
      excepturi deserunt corrupti voluptatem ab, ex facilis ratione. Voluptates
      repellat quos quis velit quidem illum numquam, ab ratione suscipit! Illo
      nobis placeat, tenetur velit aperiam dignissimos quae doloremque
      aspernatur ratione atque ab mollitia, laborum ducimus voluptatem vel
      nihil! Ducimus in sequi quos, nisi dolorem quisquam? Ex reprehenderit
      minus sequi rem voluptatem? Exercitationem quaerat rem reiciendis nostrum
      tenetur provident voluptas similique mollitia consequatur, dolorum iste
      ducimus itaque accusamus enim. Et eius commodi dicta illo eum!
      Consequatur, fuga. Ipsam alias assumenda, debitis tenetur non quis
      praesentium consequatur reprehenderit, maxime deleniti cum vitae molestiae
      provident explicabo ipsum aspernatur impedit porro accusantium? Unde
      exercitationem est debitis fugiat mollitia commodi distinctio ipsum cum
      alias doloribus? Quas sunt possimus esse, iste, quisquam doloribus culpa
      maxime blanditiis vitae nobis commodi hic sed fuga nisi quaerat!
      Voluptatibus quod commodi quis. Voluptate ratione quos blanditiis
      cupiditate dolore dolor, quibusdam deleniti, earum, esse quae provident
      distinctio soluta! Aperiam ipsam eos recusandae nisi magnam enim neque
      laborum voluptate cupiditate! Neque excepturi nam vero esse! Iure
      dignissimos ipsam distinctio rerum iste earum sint nesciunt accusamus
      eveniet molestias neque accusantium fugiat velit aut ab quod, ea deleniti
      architecto perferendis nam eos? Fugit culpa laudantium perferendis. Earum
      odit accusantium exercitationem, nisi omnis beatae reprehenderit tenetur
      impedit? Quas doloribus corrupti vel doloremque laudantium itaque
      repellendus dolores, minus temporibus? Est non quasi hic sed! A impedit in
      voluptatum amet numquam sint dolorem minima ratione, repudiandae
      recusandae consectetur assumenda, ducimus sapiente porro laudantium optio
      debitis. Eius ad fugiat alias maxime suscipit sapiente odio ipsa id.
      Voluptates enim quis doloribus. Consequatur ipsum quidem mollitia incidunt
      reiciendis. Voluptatibus beatae numquam culpa unde! Saepe labore
      temporibus perferendis earum deserunt, dolorem ab aut ea fugit tempore
      ipsa blanditiis provident! Modi, veritatis cupiditate molestias ad natus
      veniam minima facilis voluptatem, laudantium libero doloribus,
      voluptatibus quaerat itaque error in nemo dolorem deleniti commodi totam!
      Perferendis ullam quam doloremque. Excepturi, aliquid. Consequuntur? A
      aspernatur eos iure, minima officiis natus quis veniam. Asperiores
      inventore dolores voluptas nam error maiores est eos blanditiis eaque sit.
      Eligendi reprehenderit voluptatibus repellendus dicta? Reiciendis enim
      iusto veritatis? Facere quos modi suscipit maxime assumenda provident.
      Aliquam quos voluptatum dolores exercitationem modi repellat provident
      labore, laboriosam quaerat sequi maiores autem incidunt alias rem non
      consequatur eligendi similique minus ab! Quibusdam laudantium inventore
      unde magnam quidem possimus, dolores hic dolore harum, qui velit ipsa sunt
      enim. Quia distinctio, vitae veritatis aliquam mollitia autem dignissimos
      modi minus dolorum deleniti fugit necessitatibus!
    </p>
    <script>
      // let loc = {
      //   top: 0,
      //   left: 0,
      //   behavior: 'smooth'
      // }
      // window.addEventListener("keydown", function(e){
      //   loc.top = window.scrollY
      //   if(e.key === "k"){
      //     loc.top = loc.top <= 20 ? 0 : loc.top - 20
      //     window.scroll(loc)
      //   }else if(e.key === "j"){
      //     loc.top = loc.top < document.body.clientHeight - 20 ? loc.top + 20 : document.body.clientHeight
      //     window.scroll(loc)
      //   }
      // })

      window.addEventListener("keydown", function(e) {
        if (e.key === "k") {
          smoothScrollBy(window, -100, 200)
        } else if (e.key === "j") {
          smoothScrollBy(window, 100, 200)
        }
      });

      // NOTE 使用duration时间, 使window垂直方向平滑滚动pixel个像素
      function smoothScrollBy(window, pixel, duration){
        var startTime = null
        var lastTime = null
        requestAnimationFrame(function a(time){
          if(startTime === null){
            startTime = time
          }

          if(lastTime !== null){
            var timeDiff = time - lastTime
          }
          lastTime = time
          // 根据时间的比率算出每次滚动的像素距离
          var timeRatio = timeDiff / duration
          var pixelRation = timeRatio * pixel

          window.scrollBy(0, pixelRation)
          if(time - startTime < duration){
            requestAnimationFrame(a)
          }
        })
      }

      let content = document.createElement("div");
      content.id = "content";
      content.textContent = "Hi! this is a new context";
      content.style.display = "none";
      document.body.appendChild(content);
      document.body.addEventListener("contextmenu", function(e) {
        e.preventDefault();
        content.style.display = "block";
        content.style.left =
          (e.clientX + 382 > window.innerWidth
            ? window.innerWidth - 272
            : e.clientX + 30) + "px";
        content.style.top =
          (e.clientY + 77 > window.innerHeight
            ? window.innerHeight - 67
            : e.clientY + 30) + "px";
      });
      document.body.addEventListener("mousedown", function(e) {
        if (e.which !== 3) {
          content.style.display = "none";
        }
      });
    </script>
  </body>
</html>
