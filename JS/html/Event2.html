<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <title>Change Backgroundcolor</title>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <style>
        .palette {
            margin: 0;
            padding: 0;
            list-style: none;
        }
        .palette li {
            width: 40px;
            height: 40px;
            border: 1px solid #000;
            cursor: pointer;
        }
        </style>
    </head>
    <body>
        <div id="fade-obj" style="width:300px; height:300px; background:#000; opacity: 1;"></div>
        <button id="fade-btn">淡出</button>
        <ul class="palette">
            <li style="background-color: crimson"></li>
            <li style="background-color: bisque"></li>
            <li style="background-color: blueviolet"></li>
            <li style="background-color: coral"></li>
            <li style="background-color: chartreuse"></li>
            <li style="background-color: darkolivegreen"></li>
            <li style="background-color: cyan"></li>
            <li style="background-color: #194738"></li>
        </ul>
        <p class="color-picker"></p>
        <script>
            var ul_color = document.querySelector("ul");
            var p = document.getElementsByClassName("color-picker")[0];
            ul_color.addEventListener("click", function(e){
                var c = e.target.style.backgroundColor;
                p.innerHTML = c;
                p.style.backgroundColor = c;
            })

            var fade = document.getElementById("fade-obj");
            var fade_btn = document.getElementById("fade-btn");
            
            
            fade_btn.addEventListener("click", function(){
                fade_btn.disabled = true;
                if(fade_btn.innerHTML == "淡出"){
                setTimeout(function () {
                    if (fade.style.opacity <= 0) {
                        fade_btn.innerHTML = "淡入";
                        fade_btn.disabled = false;
                    } else {
                        fade.style.opacity -= 0.1;
                        setTimeout(arguments.callee, 50);
                    }
                }, 50);
            }else if(fade_btn.innerHTML == "淡入"){
                var fadeO = 0;
                setTimeout(function (){           
                    if(fade.style.opacity > 0.9){
                    fade_btn.innerHTML = "淡出";
                    fade_btn.disabled = false;
                    }else{
                    fadeO += 10;
                    console.log(fadeO);
                    fade.style.opacity = fadeO / 100;/*fade.style.opacity += 0.1 可能会重置 opacity*/
                    console.log(fade.style.opacity);
                    setTimeout(arguments.callee, 50);
                }
                }, 50);
            }
            });
            console.log(console.log(fade.style.opacity))
        </script>
    </body>
</html>